{"remainingRequest":"C:\\Users\\国强\\Desktop\\project\\vue_app_000\\vue_app_00\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\国强\\Desktop\\project\\vue_app_000\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\国强\\Desktop\\project\\vue_app_000\\vue_app_00\\src\\components\\shopping\\list\\Sku.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\国强\\Desktop\\project\\vue_app_000\\vue_app_00\\src\\components\\shopping\\list\\Sku.vue","mtime":1567612880565},{"path":"C:\\Users\\国强\\Desktop\\project\\vue_app_000\\vue_app_00\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1567606627183},{"path":"C:\\Users\\国强\\Desktop\\project\\vue_app_000\\vue_app_00\\node_modules\\babel-loader\\lib\\index.js","mtime":1567606626698},{"path":"C:\\Users\\国强\\Desktop\\project\\vue_app_000\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js","mtime":1567606641875}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  data: function data() {\n    return {\n      attrs: [],\n      sku: {\n        // 所有sku规格类目与其值的从属关系，比如商品有颜色和尺码两大类规格，颜色下面又有红色和蓝色两个规格值。\n        // 可以理解为一个商品可以有多个规格类目，一个规格类目下可以有多个规格值。\n        tree: [{\n          k: \"颜色\",\n          k_id: \"1\",\n          v: [{\n            id: \"30349\",\n            name: \"天蓝色\",\n            imgUrl: \"https://img.yzcdn.cn/upload_files/2017/02/21/FjKTOxjVgnUuPmHJRdunvYky9OHP.jpg!100x100.jpg\"\n          }, {\n            id: \"1215\",\n            name: \"白色\"\n          }],\n          k_s: \"s1\",\n          count: 2\n        }, {\n          k: \"尺寸\",\n          k_id: \"2\",\n          v: [{\n            id: \"1193\",\n            name: \"1\"\n          }, {\n            id: \"1194\",\n            name: \"2\"\n          }],\n          k_s: \"s2\",\n          count: 2\n        }],\n        // 所有 sku 的组合列表，如下是：白色1、白色2、天蓝色1、天蓝色2\n        list: [{\n          id: 2259,\n          price: 120,\n          //价格\n          discount: 122,\n          s1: \"1215\",\n          s2: \"1193\",\n          s3: \"0\",\n          s4: \"0\",\n          s5: \"0\",\n          stock_num: 20,\n          //库存\n          goods_id: 946755\n        }, {\n          id: 2260,\n          price: 110,\n          discount: 112,\n          s1: \"1215\",\n          s2: \"1194\",\n          s3: \"0\",\n          s4: \"0\",\n          s5: \"0\",\n          stock_num: 2,\n          //库存\n          goods_id: 946755\n        }, {\n          id: 2257,\n          price: 130,\n          discount: 132,\n          s1: \"30349\",\n          s2: \"1193\",\n          s3: \"0\",\n          s4: \"0\",\n          s5: \"0\",\n          stock_num: 40,\n          //库存\n          goods_id: 946755\n        }, {\n          id: 2258,\n          price: 100,\n          discount: 100,\n          s1: \"30349\",\n          s2: \"1194\",\n          s3: \"0\",\n          s4: \"0\",\n          s5: \"0\",\n          stock_num: 50,\n          //库存\n          goods_id: 946755\n        }],\n        price: \"5.00\",\n        stock_num: 227,\n        // 商品总库存\n        none_sku: false,\n        // 是否无规格商品\n        hide_stock: false // 是否隐藏剩余库存\n\n      },\n      goods_id: \"946755\",\n      quota: 3,\n      //限购数量\n      quota_used: 0,\n      //已经购买过的数量\n      goods_info: {\n        title: \"测试商品A\",\n        picture: \"https://img.yzcdn.cn/upload_files/2017/03/16/Fs_OMbSFPa183sBwvG_94llUYiLa.jpeg?imageView2/2/w/100/h/100/q/75/format/jpg\"\n      },\n      initialSku: {\n        s1: \"0001\",\n        s2: \"1001\",\n        selectedNum: 3\n      }\n    };\n  },\n  mounted: function mounted() {//console.log(this.attrs);\n    //console.log(this.tableData);\n    //console.log(this.rows);\n    //console.log(this.tableList);\n  },\n  filters: {\n    getName: function getName(obj, index) {\n      if (obj) {\n        var r = parseInt((index - 1) / obj[\"rowspan\"]);\n        var l = obj[\"specLen\"] || 1;\n        var key = r % l;\n        return obj[\"spec\"] && obj[\"spec\"][key] && obj[\"spec\"][key][\"cName\"];\n      }\n    }\n  },\n  computed: {\n    tableData: function tableData() {\n      var attrs = this.attrs;\n      var len = attrs.length;\n\n      if (len == 0) {\n        return;\n      }\n\n      var tData = []; //初始化tableData\n\n      for (var i = 0; i < len; i++) {\n        var row = {};\n        row[\"pName\"] = attrs[i][\"pName\"];\n        row[\"spec\"] = [];\n        row[\"price\"] = {};\n        row[\"number\"] = {};\n        var len2 = attrs[i][\"spec\"].length;\n        var specLen = 0;\n\n        for (var j = 0; j < len2; j++) {\n          var spe = {};\n          var cName = attrs[i][\"spec\"][j][\"cName\"];\n\n          if (!cName) {\n            continue;\n          }\n\n          ++specLen;\n          spe[\"cName\"] = cName;\n          row[\"spec\"].push(spe);\n        }\n\n        row[\"specLen\"] = specLen;\n        tData.push(row);\n      } //获取rowspan\n\n\n      for (var k = 0, len3 = tData.length; k < len3; k++) {\n        var rowspan = 1;\n\n        for (var k1 = k + 1; k1 < len3; k1++) {\n          var kSpecLen = tData[k1][\"specLen\"] || 1;\n          rowspan *= kSpecLen;\n        }\n\n        tData[k][\"rowspan\"] = rowspan;\n      }\n\n      return tData;\n    },\n    rows: function rows() {\n      if (!this.tableData) {\n        return;\n      }\n\n      var rows = 1;\n      var tableData = this.tableData;\n      var len = tableData.length;\n\n      for (var i = 0; i < len; i++) {\n        var specLen = tableData[i][\"specLen\"] || 1;\n        rows *= specLen;\n      } //每条rowspan都为1情况\n\n\n      if (rows == 1) {\n        return tableData[0][\"spec\"].length;\n      }\n\n      return rows;\n    },\n    tableList: function tableList() {\n      if (!this.tableData) {\n        return;\n      }\n\n      var rows = this.rows;\n      var tList = [];\n      var srcData = this.tableData; //console.log(srcData);\n\n      for (var i = 0; i < rows; i++) {\n        var listItem = {}; //构建动态项\n\n        for (var j = 0; j < srcData.length; j++) {\n          //构造第一类目\n          var key = srcData[j][\"pName\"];\n          var rowspan = srcData[j][\"rowspan\"];\n          var len = srcData[j][\"specLen\"];\n\n          if (!len) {\n            continue;\n          }\n\n          var spec = srcData[j][\"spec\"];\n          var index = parseInt(i / rowspan) % len;\n          listItem[key] = spec[index][\"cName\"];\n        } //构建固定项(price,number)\n\n\n        listItem[\"price\"] = \"\";\n        listItem[\"number\"] = \"\";\n        tList.push(listItem);\n      }\n\n      return tList;\n    }\n  },\n  components: {},\n  methods: {\n    addItem: function addItem() {\n      var obj = {\n        pName: \"\",\n        rowspan: 1,\n        spec: [{\n          cName: \"\"\n        }, {\n          cName: \"\"\n        }, {\n          cName: \"\"\n        }, {\n          cName: \"\"\n        }, {\n          cName: \"\"\n        }, {\n          cName: \"\"\n        }, {\n          cName: \"\"\n        }, {\n          cName: \"\"\n        }]\n      };\n\n      if (this.attrs.length >= 3) {\n        return;\n      }\n\n      this.attrs.push(obj);\n    },\n    toDelete: function toDelete(index) {\n      this.attrs.splice(index, 1);\n    },\n    toConfirm: function toConfirm() {\n      // console.log(this.tableList);\n      alert(JSON.stringify(this.tableList));\n    }\n  }\n};",{"version":3,"sources":["Sku.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class>\r\n    <div class=\"form-group\">\r\n      <div class=\"form-h\">商品规格</div>\r\n      <div class=\"form-item\" v-for=\"(attr,index) in attrs\" :key=\"`attr${index}`\">\r\n        <div class=\"form-title\">\r\n          <input type=\"text\" name value v-model=\"attr.pName\" placeholder=\"规格名\" />\r\n          <span class=\"delete\" @click=\"toDelete(index)\">×</span>\r\n        </div>\r\n        <ul class=\"form-list\">\r\n          <li v-for=\"(item,index2) in attr.spec\" :key=\"`item${index2}`\">\r\n            <input class=\"spec-item\" type=\"text\" name value v-model=\"item.cName\" />\r\n          </li>\r\n        </ul>\r\n      </div>\r\n      <div class=\"form-btn-group\">\r\n        <button class=\"btn\" type=\"button\" name @click=\"addItem\">添加规格项目</button>\r\n      </div>\r\n      <div class=\"form-table\" v-show=\"tableData\">\r\n        <div class=\"stock-title\">商品库存</div>\r\n        <table class=\"table-sku\" border=\"1px solid #ccc\">\r\n          <thead>\r\n            <tr>\r\n              <td v-for=\"(list,index) in tableData\" :key=\"`list${index}`\">{{list['pName']}}</td>\r\n              <td>价格</td>\r\n              <td>数量</td>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"(row,index) in rows\" :key=\"`row${index}`\">\r\n              <td\r\n                v-for=\"(item,index2) in tableData\"\r\n                v-if=\"!((row-1)%item['rowspan'])\"\r\n                :rowspan=\"item['rowspan']\"\r\n                :key=\"`item${index2}`\"\r\n              >{{item|getName(row)}}</td>\r\n              <td>\r\n                <input type=\"text\" v-model=\"tableList[row-1]['price']\" />\r\n              </td>\r\n              <td>\r\n                <input type=\"text\" v-model=\"tableList[row-1]['number']\" />\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n        <div class=\"form-btn-group\">\r\n          <button class=\"btn\" type=\"button\" name @click=\"toConfirm\">确认</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      attrs: [],\r\n      sku: {\r\n        // 所有sku规格类目与其值的从属关系，比如商品有颜色和尺码两大类规格，颜色下面又有红色和蓝色两个规格值。\r\n        // 可以理解为一个商品可以有多个规格类目，一个规格类目下可以有多个规格值。\r\n        tree: [\r\n          {\r\n            k: \"颜色\",\r\n            k_id: \"1\",\r\n            v: [\r\n              {\r\n                id: \"30349\",\r\n                name: \"天蓝色\",\r\n                imgUrl:\r\n                  \"https://img.yzcdn.cn/upload_files/2017/02/21/FjKTOxjVgnUuPmHJRdunvYky9OHP.jpg!100x100.jpg\"\r\n              },\r\n              {\r\n                id: \"1215\",\r\n                name: \"白色\"\r\n              }\r\n            ],\r\n            k_s: \"s1\",\r\n            count: 2\r\n          },\r\n          {\r\n            k: \"尺寸\",\r\n            k_id: \"2\",\r\n            v: [\r\n              {\r\n                id: \"1193\",\r\n                name: \"1\"\r\n              },\r\n              {\r\n                id: \"1194\",\r\n                name: \"2\"\r\n              }\r\n            ],\r\n            k_s: \"s2\",\r\n            count: 2\r\n          }\r\n        ],\r\n        // 所有 sku 的组合列表，如下是：白色1、白色2、天蓝色1、天蓝色2\r\n        list: [\r\n          {\r\n            id: 2259,\r\n            price: 120, //价格\r\n            discount: 122,\r\n            s1: \"1215\",\r\n            s2: \"1193\",\r\n            s3: \"0\",\r\n            s4: \"0\",\r\n            s5: \"0\",\r\n            stock_num: 20, //库存\r\n            goods_id: 946755\r\n          },\r\n          {\r\n            id: 2260,\r\n            price: 110,\r\n            discount: 112,\r\n            s1: \"1215\",\r\n            s2: \"1194\",\r\n            s3: \"0\",\r\n            s4: \"0\",\r\n            s5: \"0\",\r\n            stock_num: 2, //库存\r\n            goods_id: 946755\r\n          },\r\n          {\r\n            id: 2257,\r\n            price: 130,\r\n            discount: 132,\r\n            s1: \"30349\",\r\n            s2: \"1193\",\r\n            s3: \"0\",\r\n            s4: \"0\",\r\n            s5: \"0\",\r\n            stock_num: 40, //库存\r\n            goods_id: 946755\r\n          },\r\n          {\r\n            id: 2258,\r\n            price: 100,\r\n            discount: 100,\r\n            s1: \"30349\",\r\n            s2: \"1194\",\r\n            s3: \"0\",\r\n            s4: \"0\",\r\n            s5: \"0\",\r\n            stock_num: 50, //库存\r\n            goods_id: 946755\r\n          }\r\n        ],\r\n        price: \"5.00\",\r\n        stock_num: 227, // 商品总库存\r\n        none_sku: false, // 是否无规格商品\r\n        hide_stock: false // 是否隐藏剩余库存\r\n      },\r\n      goods_id: \"946755\",\r\n      quota: 3, //限购数量\r\n      quota_used: 0, //已经购买过的数量\r\n      goods_info: {\r\n        title: \"测试商品A\",\r\n        picture:\r\n          \"https://img.yzcdn.cn/upload_files/2017/03/16/Fs_OMbSFPa183sBwvG_94llUYiLa.jpeg?imageView2/2/w/100/h/100/q/75/format/jpg\"\r\n      },\r\n      initialSku: {\r\n        s1: \"0001\",\r\n        s2: \"1001\",\r\n        selectedNum: 3\r\n      }\r\n    };\r\n  },\r\n\r\n  mounted() {\r\n    //console.log(this.attrs);\r\n    //console.log(this.tableData);\r\n    //console.log(this.rows);\r\n    //console.log(this.tableList);\r\n  },\r\n  filters: {\r\n    getName: function(obj, index) {\r\n      if (obj) {\r\n        var r = parseInt((index - 1) / obj[\"rowspan\"]);\r\n        var l = obj[\"specLen\"] || 1;\r\n        var key = r % l;\r\n        return obj[\"spec\"] && obj[\"spec\"][key] && obj[\"spec\"][key][\"cName\"];\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    tableData: function() {\r\n      var attrs = this.attrs;\r\n      var len = attrs.length;\r\n      if (len == 0) {\r\n        return;\r\n      }\r\n      var tData = [];\r\n      //初始化tableData\r\n      for (var i = 0; i < len; i++) {\r\n        var row = {};\r\n        row[\"pName\"] = attrs[i][\"pName\"];\r\n        row[\"spec\"] = [];\r\n        row[\"price\"] = {};\r\n        row[\"number\"] = {};\r\n        var len2 = attrs[i][\"spec\"].length;\r\n        var specLen = 0;\r\n        for (var j = 0; j < len2; j++) {\r\n          var spe = {};\r\n          var cName = attrs[i][\"spec\"][j][\"cName\"];\r\n          if (!cName) {\r\n            continue;\r\n          }\r\n          ++specLen;\r\n          spe[\"cName\"] = cName;\r\n          row[\"spec\"].push(spe);\r\n        }\r\n        row[\"specLen\"] = specLen;\r\n        tData.push(row);\r\n      }\r\n      //获取rowspan\r\n      for (var k = 0, len3 = tData.length; k < len3; k++) {\r\n        var rowspan = 1;\r\n        for (var k1 = k + 1; k1 < len3; k1++) {\r\n          var kSpecLen = tData[k1][\"specLen\"] || 1;\r\n          rowspan *= kSpecLen;\r\n        }\r\n        tData[k][\"rowspan\"] = rowspan;\r\n      }\r\n      return tData;\r\n    },\r\n    rows: function() {\r\n      if (!this.tableData) {\r\n        return;\r\n      }\r\n      var rows = 1;\r\n      var tableData = this.tableData;\r\n      var len = tableData.length;\r\n      for (var i = 0; i < len; i++) {\r\n        var specLen = tableData[i][\"specLen\"] || 1;\r\n        rows *= specLen;\r\n      }\r\n      //每条rowspan都为1情况\r\n      if (rows == 1) {\r\n        return tableData[0][\"spec\"].length;\r\n      }\r\n      return rows;\r\n    },\r\n    tableList: function() {\r\n      if (!this.tableData) {\r\n        return;\r\n      }\r\n      var rows = this.rows;\r\n      var tList = [];\r\n      var srcData = this.tableData;\r\n      //console.log(srcData);\r\n      for (var i = 0; i < rows; i++) {\r\n        var listItem = {};\r\n        //构建动态项\r\n        for (var j = 0; j < srcData.length; j++) {\r\n          //构造第一类目\r\n          var key = srcData[j][\"pName\"];\r\n          var rowspan = srcData[j][\"rowspan\"];\r\n          var len = srcData[j][\"specLen\"];\r\n          if (!len) {\r\n            continue;\r\n          }\r\n          var spec = srcData[j][\"spec\"];\r\n          var index = parseInt(i / rowspan) % len;\r\n          listItem[key] = spec[index][\"cName\"];\r\n        }\r\n        //构建固定项(price,number)\r\n        listItem[\"price\"] = \"\";\r\n        listItem[\"number\"] = \"\";\r\n        tList.push(listItem);\r\n      }\r\n      return tList;\r\n    }\r\n  },\r\n  components: {},\r\n  methods: {\r\n    addItem: function() {\r\n      var obj = {\r\n        pName: \"\",\r\n        rowspan: 1,\r\n        spec: [\r\n          { cName: \"\" },\r\n          { cName: \"\" },\r\n          { cName: \"\" },\r\n          { cName: \"\" },\r\n          { cName: \"\" },\r\n          { cName: \"\" },\r\n          { cName: \"\" },\r\n          { cName: \"\" }\r\n        ]\r\n      };\r\n      if (this.attrs.length >= 3) {\r\n        return;\r\n      }\r\n      this.attrs.push(obj);\r\n    },\r\n    toDelete: function(index) {\r\n      this.attrs.splice(index, 1);\r\n    },\r\n    toConfirm: function() {\r\n      // console.log(this.tableList);\r\n      alert(JSON.stringify(this.tableList));\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"css\">\r\n/**reset*/\r\nbutton,\r\ninput {\r\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\r\n  outline: none;\r\n}\r\n.btn {\r\n  padding: 4px 12px;\r\n  margin-bottom: 0;\r\n  font-size: 14px;\r\n  color: #333;\r\n  vertical-align: middle;\r\n  cursor: pointer;\r\n  background-color: #f8f8f8;\r\n  border: 1px solid #ddd;\r\n  -webkit-border-radius: 2px;\r\n  -moz-border-radius: 2px;\r\n  border-radius: 2px;\r\n}\r\n.btn.active,\r\n.btn:active,\r\n.btn:focus,\r\n.btn:hover {\r\n  text-decoration: none;\r\n  color: #333;\r\n  background-color: #fcfcfc;\r\n  border-color: #ccc;\r\n}\r\n/*table*/\r\ntable {\r\n  border: 0;\r\n}\r\ntable.table-sku {\r\n  width: 100%;\r\n  background-color: #fff;\r\n  text-align: left;\r\n}\r\ntable {\r\n  border-collapse: collapse;\r\n  border-spacing: 0;\r\n}\r\ntable.table-sku td {\r\n  border: 1px solid #e5e5e5;\r\n  padding: 8px;\r\n}\r\ntable.table-sku td input {\r\n  padding: 10px;\r\n  border: 1px solid #ccc;\r\n}\r\n/**/\r\n.form-title {\r\n  background: #f8f8f8;\r\n  padding: 10px;\r\n  position: relative;\r\n}\r\n.form-title .label {\r\n  color: #999;\r\n}\r\n.form-title .delete {\r\n  width: 20px;\r\n  height: 20px;\r\n  line-height: 20px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 50%;\r\n  position: absolute;\r\n  right: 15px;\r\n  top: 50%;\r\n  margin-top: -10px;\r\n  text-align: center;\r\n  color: #fff;\r\n  background: #ccc;\r\n  cursor: pointer;\r\n}\r\n.form-title input {\r\n  background: #fff;\r\n  border: 1px solid #ccc;\r\n  padding: 10px;\r\n}\r\n.form-list {\r\n  padding: 10px;\r\n  margin-top: 0;\r\n}\r\n.form-list li {\r\n  display: inline-block;\r\n  margin-top: 10px;\r\n}\r\n.spec-item {\r\n  width: 100px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n}\r\n.form-list,\r\n.form-title {\r\n  text-align: left;\r\n}\r\n.form-list input {\r\n  background: #fff;\r\n  margin-right: 10px;\r\n  border: 1px solid #ccc;\r\n  padding: 10px;\r\n}\r\n.form-group {\r\n  border: 1px solid #ccc;\r\n  padding: 10px;\r\n}\r\n.form-table {\r\n  margin-top: 50px;\r\n}\r\n.form-btn-group {\r\n  margin-top: 20px;\r\n  background: #f8f8f8;\r\n  padding: 10px;\r\n}\r\n.stock-title,\r\n.form-h {\r\n  height: 40px;\r\n  line-height: 40px;\r\n}\r\n</style>\r\n"],"sourceRoot":"src\\components\\shopping\\list"}]}