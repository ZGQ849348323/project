{"remainingRequest":"E:\\project\\vue_app_000\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\project\\vue_app_000\\vue_app_00\\src\\components\\shopping\\list\\Sku.vue?vue&type=style&index=0&lang=css","dependencies":[{"path":"E:\\project\\vue_app_000\\vue_app_00\\src\\components\\shopping\\list\\Sku.vue","mtime":1567669856617},{"path":"E:\\project\\vue_app_000\\vue_app_00\\node_modules\\css-loader\\index.js","mtime":1567669842584},{"path":"E:\\project\\vue_app_000\\vue_app_00\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1567669856039},{"path":"E:\\project\\vue_app_000\\vue_app_00\\node_modules\\postcss-loader\\lib\\index.js","mtime":1567669850288},{"path":"E:\\project\\vue_app_000\\vue_app_00\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1567669840818},{"path":"E:\\project\\vue_app_000\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js","mtime":1567669856039}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n/**reset*/\r\nbutton,\r\ninput {\r\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\r\n  outline: none;\r\n}\r\n.btn {\r\n  padding: 4px 12px;\r\n  margin-bottom: 0;\r\n  font-size: 14px;\r\n  color: #333;\r\n  vertical-align: middle;\r\n  cursor: pointer;\r\n  background-color: #f8f8f8;\r\n  border: 1px solid #ddd;\r\n  -webkit-border-radius: 2px;\r\n  -moz-border-radius: 2px;\r\n  border-radius: 2px;\r\n}\r\n.btn.active,\r\n.btn:active,\r\n.btn:focus,\r\n.btn:hover {\r\n  text-decoration: none;\r\n  color: #333;\r\n  background-color: #fcfcfc;\r\n  border-color: #ccc;\r\n}\r\n/*table*/\r\ntable {\r\n  border: 0;\r\n}\r\ntable.table-sku {\r\n  width: 100%;\r\n  background-color: #fff;\r\n  text-align: left;\r\n}\r\ntable {\r\n  border-collapse: collapse;\r\n  border-spacing: 0;\r\n}\r\ntable.table-sku td {\r\n  border: 1px solid #e5e5e5;\r\n  padding: 8px;\r\n}\r\ntable.table-sku td input {\r\n  padding: 10px;\r\n  border: 1px solid #ccc;\r\n}\r\n/**/\r\n.form-title {\r\n  background: #f8f8f8;\r\n  padding: 10px;\r\n  position: relative;\r\n}\r\n.form-title .label {\r\n  color: #999;\r\n}\r\n.form-title .delete {\r\n  width: 20px;\r\n  height: 20px;\r\n  line-height: 20px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 50%;\r\n  position: absolute;\r\n  right: 15px;\r\n  top: 50%;\r\n  margin-top: -10px;\r\n  text-align: center;\r\n  color: #fff;\r\n  background: #ccc;\r\n  cursor: pointer;\r\n}\r\n.form-title input {\r\n  background: #fff;\r\n  border: 1px solid #ccc;\r\n  padding: 10px;\r\n}\r\n.form-list {\r\n  padding: 10px;\r\n  margin-top: 0;\r\n}\r\n.form-list li {\r\n  display: inline-block;\r\n  margin-top: 10px;\r\n}\r\n.spec-item {\r\n  width: 100px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n}\r\n.form-list,\r\n.form-title {\r\n  text-align: left;\r\n}\r\n.form-list input {\r\n  background: #fff;\r\n  margin-right: 10px;\r\n  border: 1px solid #ccc;\r\n  padding: 10px;\r\n}\r\n.form-group {\r\n  border: 1px solid #ccc;\r\n  padding: 10px;\r\n}\r\n.form-table {\r\n  margin-top: 50px;\r\n}\r\n.form-btn-group {\r\n  margin-top: 20px;\r\n  background: #f8f8f8;\r\n  padding: 10px;\r\n}\r\n.stock-title,\r\n.form-h {\r\n  height: 40px;\r\n  line-height: 40px;\r\n}\r\n",{"version":3,"sources":["Sku.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Sku.vue","sourceRoot":"src\\components\\shopping\\list","sourcesContent":["<template>\r\n  <div class>\r\n    <div class=\"form-group\">\r\n      <div class=\"form-h\">商品规格</div>\r\n      <div class=\"form-item\" v-for=\"(attr,index) in attrs\" :key=\"`attr${index}`\">\r\n        <div class=\"form-title\">\r\n          <input type=\"text\" name value v-model=\"attr.pName\" placeholder=\"规格名\" />\r\n          <span class=\"delete\" @click=\"toDelete(index)\">×</span>\r\n        </div>\r\n        <ul class=\"form-list\">\r\n          <li v-for=\"(item,index2) in attr.spec\" :key=\"`item${index2}`\">\r\n            <input class=\"spec-item\" type=\"text\" name value v-model=\"item.cName\" />\r\n          </li>\r\n        </ul>\r\n      </div>\r\n      <div class=\"form-btn-group\">\r\n        <button class=\"btn\" type=\"button\" name @click=\"addItem\">添加规格项目</button>\r\n      </div>\r\n      <div class=\"form-table\" v-show=\"tableData\">\r\n        <div class=\"stock-title\">商品库存</div>\r\n        <table class=\"table-sku\" border=\"1px solid #ccc\">\r\n          <thead>\r\n            <tr>\r\n              <td v-for=\"(list,index) in tableData\" :key=\"`list${index}`\">{{list['pName']}}</td>\r\n              <td>价格</td>\r\n              <td>数量</td>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"(row,index) in rows\" :key=\"`row${index}`\">\r\n              <td\r\n                v-for=\"(item,index2) in tableData\"\r\n                v-if=\"!((row-1)%item['rowspan'])\"\r\n                :rowspan=\"item['rowspan']\"\r\n                :key=\"`item${index2}`\"\r\n              >{{item|getName(row)}}</td>\r\n              <td>\r\n                <input type=\"text\" v-model=\"tableList[row-1]['price']\" />\r\n              </td>\r\n              <td>\r\n                <input type=\"text\" v-model=\"tableList[row-1]['number']\" />\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n        <div class=\"form-btn-group\">\r\n          <button class=\"btn\" type=\"button\" name @click=\"toConfirm\">确认</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      attrs: [],\r\n      sku: {\r\n        // 所有sku规格类目与其值的从属关系，比如商品有颜色和尺码两大类规格，颜色下面又有红色和蓝色两个规格值。\r\n        // 可以理解为一个商品可以有多个规格类目，一个规格类目下可以有多个规格值。\r\n        tree: [\r\n          {\r\n            k: \"颜色\",\r\n            k_id: \"1\",\r\n            v: [\r\n              {\r\n                id: \"30349\",\r\n                name: \"天蓝色\",\r\n                imgUrl:\r\n                  \"https://img.yzcdn.cn/upload_files/2017/02/21/FjKTOxjVgnUuPmHJRdunvYky9OHP.jpg!100x100.jpg\"\r\n              },\r\n              {\r\n                id: \"1215\",\r\n                name: \"白色\"\r\n              }\r\n            ],\r\n            k_s: \"s1\",\r\n            count: 2\r\n          },\r\n          {\r\n            k: \"尺寸\",\r\n            k_id: \"2\",\r\n            v: [\r\n              {\r\n                id: \"1193\",\r\n                name: \"1\"\r\n              },\r\n              {\r\n                id: \"1194\",\r\n                name: \"2\"\r\n              }\r\n            ],\r\n            k_s: \"s2\",\r\n            count: 2\r\n          }\r\n        ],\r\n        // 所有 sku 的组合列表，如下是：白色1、白色2、天蓝色1、天蓝色2\r\n        list: [\r\n          {\r\n            id: 2259,\r\n            price: 120, //价格\r\n            discount: 122,\r\n            s1: \"1215\",\r\n            s2: \"1193\",\r\n            s3: \"0\",\r\n            s4: \"0\",\r\n            s5: \"0\",\r\n            stock_num: 20, //库存\r\n            goods_id: 946755\r\n          },\r\n          {\r\n            id: 2260,\r\n            price: 110,\r\n            discount: 112,\r\n            s1: \"1215\",\r\n            s2: \"1194\",\r\n            s3: \"0\",\r\n            s4: \"0\",\r\n            s5: \"0\",\r\n            stock_num: 2, //库存\r\n            goods_id: 946755\r\n          },\r\n          {\r\n            id: 2257,\r\n            price: 130,\r\n            discount: 132,\r\n            s1: \"30349\",\r\n            s2: \"1193\",\r\n            s3: \"0\",\r\n            s4: \"0\",\r\n            s5: \"0\",\r\n            stock_num: 40, //库存\r\n            goods_id: 946755\r\n          },\r\n          {\r\n            id: 2258,\r\n            price: 100,\r\n            discount: 100,\r\n            s1: \"30349\",\r\n            s2: \"1194\",\r\n            s3: \"0\",\r\n            s4: \"0\",\r\n            s5: \"0\",\r\n            stock_num: 50, //库存\r\n            goods_id: 946755\r\n          }\r\n        ],\r\n        price: \"5.00\",\r\n        stock_num: 227, // 商品总库存\r\n        none_sku: false, // 是否无规格商品\r\n        hide_stock: false // 是否隐藏剩余库存\r\n      },\r\n      goods_id: \"946755\",\r\n      quota: 3, //限购数量\r\n      quota_used: 0, //已经购买过的数量\r\n      goods_info: {\r\n        title: \"测试商品A\",\r\n        picture:\r\n          \"https://img.yzcdn.cn/upload_files/2017/03/16/Fs_OMbSFPa183sBwvG_94llUYiLa.jpeg?imageView2/2/w/100/h/100/q/75/format/jpg\"\r\n      },\r\n      initialSku: {\r\n        s1: \"0001\",\r\n        s2: \"1001\",\r\n        selectedNum: 3\r\n      }\r\n    };\r\n  },\r\n\r\n  mounted() {\r\n    //console.log(this.attrs);\r\n    //console.log(this.tableData);\r\n    //console.log(this.rows);\r\n    //console.log(this.tableList);\r\n  },\r\n  filters: {\r\n    getName: function(obj, index) {\r\n      if (obj) {\r\n        var r = parseInt((index - 1) / obj[\"rowspan\"]);\r\n        var l = obj[\"specLen\"] || 1;\r\n        var key = r % l;\r\n        return obj[\"spec\"] && obj[\"spec\"][key] && obj[\"spec\"][key][\"cName\"];\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    tableData: function() {\r\n      var attrs = this.attrs;\r\n      var len = attrs.length;\r\n      if (len == 0) {\r\n        return;\r\n      }\r\n      var tData = [];\r\n      //初始化tableData\r\n      for (var i = 0; i < len; i++) {\r\n        var row = {};\r\n        row[\"pName\"] = attrs[i][\"pName\"];\r\n        row[\"spec\"] = [];\r\n        row[\"price\"] = {};\r\n        row[\"number\"] = {};\r\n        var len2 = attrs[i][\"spec\"].length;\r\n        var specLen = 0;\r\n        for (var j = 0; j < len2; j++) {\r\n          var spe = {};\r\n          var cName = attrs[i][\"spec\"][j][\"cName\"];\r\n          if (!cName) {\r\n            continue;\r\n          }\r\n          ++specLen;\r\n          spe[\"cName\"] = cName;\r\n          row[\"spec\"].push(spe);\r\n        }\r\n        row[\"specLen\"] = specLen;\r\n        tData.push(row);\r\n      }\r\n      //获取rowspan\r\n      for (var k = 0, len3 = tData.length; k < len3; k++) {\r\n        var rowspan = 1;\r\n        for (var k1 = k + 1; k1 < len3; k1++) {\r\n          var kSpecLen = tData[k1][\"specLen\"] || 1;\r\n          rowspan *= kSpecLen;\r\n        }\r\n        tData[k][\"rowspan\"] = rowspan;\r\n      }\r\n      return tData;\r\n    },\r\n    rows: function() {\r\n      if (!this.tableData) {\r\n        return;\r\n      }\r\n      var rows = 1;\r\n      var tableData = this.tableData;\r\n      var len = tableData.length;\r\n      for (var i = 0; i < len; i++) {\r\n        var specLen = tableData[i][\"specLen\"] || 1;\r\n        rows *= specLen;\r\n      }\r\n      //每条rowspan都为1情况\r\n      if (rows == 1) {\r\n        return tableData[0][\"spec\"].length;\r\n      }\r\n      return rows;\r\n    },\r\n    tableList: function() {\r\n      if (!this.tableData) {\r\n        return;\r\n      }\r\n      var rows = this.rows;\r\n      var tList = [];\r\n      var srcData = this.tableData;\r\n      //console.log(srcData);\r\n      for (var i = 0; i < rows; i++) {\r\n        var listItem = {};\r\n        //构建动态项\r\n        for (var j = 0; j < srcData.length; j++) {\r\n          //构造第一类目\r\n          var key = srcData[j][\"pName\"];\r\n          var rowspan = srcData[j][\"rowspan\"];\r\n          var len = srcData[j][\"specLen\"];\r\n          if (!len) {\r\n            continue;\r\n          }\r\n          var spec = srcData[j][\"spec\"];\r\n          var index = parseInt(i / rowspan) % len;\r\n          listItem[key] = spec[index][\"cName\"];\r\n        }\r\n        //构建固定项(price,number)\r\n        listItem[\"price\"] = \"\";\r\n        listItem[\"number\"] = \"\";\r\n        tList.push(listItem);\r\n      }\r\n      return tList;\r\n    }\r\n  },\r\n  components: {},\r\n  methods: {\r\n    addItem: function() {\r\n      var obj = {\r\n        pName: \"\",\r\n        rowspan: 1,\r\n        spec: [\r\n          { cName: \"\" },\r\n          { cName: \"\" },\r\n          { cName: \"\" },\r\n          { cName: \"\" },\r\n          { cName: \"\" },\r\n          { cName: \"\" },\r\n          { cName: \"\" },\r\n          { cName: \"\" }\r\n        ]\r\n      };\r\n      if (this.attrs.length >= 3) {\r\n        return;\r\n      }\r\n      this.attrs.push(obj);\r\n    },\r\n    toDelete: function(index) {\r\n      this.attrs.splice(index, 1);\r\n    },\r\n    toConfirm: function() {\r\n      // console.log(this.tableList);\r\n      alert(JSON.stringify(this.tableList));\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"css\">\r\n/**reset*/\r\nbutton,\r\ninput {\r\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\r\n  outline: none;\r\n}\r\n.btn {\r\n  padding: 4px 12px;\r\n  margin-bottom: 0;\r\n  font-size: 14px;\r\n  color: #333;\r\n  vertical-align: middle;\r\n  cursor: pointer;\r\n  background-color: #f8f8f8;\r\n  border: 1px solid #ddd;\r\n  -webkit-border-radius: 2px;\r\n  -moz-border-radius: 2px;\r\n  border-radius: 2px;\r\n}\r\n.btn.active,\r\n.btn:active,\r\n.btn:focus,\r\n.btn:hover {\r\n  text-decoration: none;\r\n  color: #333;\r\n  background-color: #fcfcfc;\r\n  border-color: #ccc;\r\n}\r\n/*table*/\r\ntable {\r\n  border: 0;\r\n}\r\ntable.table-sku {\r\n  width: 100%;\r\n  background-color: #fff;\r\n  text-align: left;\r\n}\r\ntable {\r\n  border-collapse: collapse;\r\n  border-spacing: 0;\r\n}\r\ntable.table-sku td {\r\n  border: 1px solid #e5e5e5;\r\n  padding: 8px;\r\n}\r\ntable.table-sku td input {\r\n  padding: 10px;\r\n  border: 1px solid #ccc;\r\n}\r\n/**/\r\n.form-title {\r\n  background: #f8f8f8;\r\n  padding: 10px;\r\n  position: relative;\r\n}\r\n.form-title .label {\r\n  color: #999;\r\n}\r\n.form-title .delete {\r\n  width: 20px;\r\n  height: 20px;\r\n  line-height: 20px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 50%;\r\n  position: absolute;\r\n  right: 15px;\r\n  top: 50%;\r\n  margin-top: -10px;\r\n  text-align: center;\r\n  color: #fff;\r\n  background: #ccc;\r\n  cursor: pointer;\r\n}\r\n.form-title input {\r\n  background: #fff;\r\n  border: 1px solid #ccc;\r\n  padding: 10px;\r\n}\r\n.form-list {\r\n  padding: 10px;\r\n  margin-top: 0;\r\n}\r\n.form-list li {\r\n  display: inline-block;\r\n  margin-top: 10px;\r\n}\r\n.spec-item {\r\n  width: 100px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n}\r\n.form-list,\r\n.form-title {\r\n  text-align: left;\r\n}\r\n.form-list input {\r\n  background: #fff;\r\n  margin-right: 10px;\r\n  border: 1px solid #ccc;\r\n  padding: 10px;\r\n}\r\n.form-group {\r\n  border: 1px solid #ccc;\r\n  padding: 10px;\r\n}\r\n.form-table {\r\n  margin-top: 50px;\r\n}\r\n.form-btn-group {\r\n  margin-top: 20px;\r\n  background: #f8f8f8;\r\n  padding: 10px;\r\n}\r\n.stock-title,\r\n.form-h {\r\n  height: 40px;\r\n  line-height: 40px;\r\n}\r\n</style>\r\n"]}]}